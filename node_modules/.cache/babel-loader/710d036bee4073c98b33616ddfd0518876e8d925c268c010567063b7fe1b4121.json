{"ast":null,"code":"var clientID=\"bc57124bede849018a048bcb3284f8be\";var redirectURI=\"http://localhost:3000/\";var accessToken;var Spotify={getAccessToken:function getAccessToken(){if(accessToken){return accessToken;}//check for access token match\nvar accessTokenMatch=window.location.href.match(/access_token=([^&]*)/);var expiresInMatch=window.location.href.match(/expires_in=([^&]*)/);if(accessTokenMatch&&expiresInMatch){accessToken=accessTokenMatch[1];var expiresIn=Number(expiresInMatch[1]);//This clears the paramenters allowsing us to grab a new access token when it expires\nwindow.setTimeout(function(){return accessToken='';},expiresIn*1000);window.history.pushState('Access Token',null,'/');return accessToken;}else{var accessURL=\"https://accounts.spotify.com/authorize?client_id=\".concat(clientID,\"&response_type=token&scope=playlist-modify-public&redirect_uri=\").concat(redirectURI);window.location=accessURL;}},search:function search(term){var accessToken=Spotify.getAccessToken();return fetch(\"https://api.spotify.com/v1/search?type=track&q=\".concat(term),{headers:{Authorization:\"Bearer \".concat(accessToken)}}).then(function(response){return response.json();}).then(function(jsonResponse){if(!jsonResponse.tracks){return[];}return jsonResponse.tracks.items.map(function(track){return{id:track.id,name:track.name,artists:track.artists[0].name,album:track.album.name,uri:track.uri};});});},savePlayList:function savePlayList(name,trackURIs){if(!name||!trackURIs.length){return;}var accessToken=Spotify.getAccessToken();var headers={Authorization:\"Bearer \".concat(accessToken)};var userId;return fetch('https://api.spotify.com/v1/me',{headers:headers}).then(function(response){return response.json();}).then(function(jsonResponse){userId=jsonResponse.id;return fetch(\"https://api.spotify.com/v1/users/\".concat(userId,\"/playlists\"),{headers:headers,method:'POST',body:JSON.stringify({name:name})}).then(function(response){return response.json();}).then(function(jsonResponse){var playlistID=jsonResponse.id;console.log(playlistID);return fetch(\"https://api.spotify.com/v1/users/\".concat(userId,\"/playlists/\").concat(playlistID,\"/tracks\"),{headers:headers,method:'POST',body:JSON.stringify({uris:trackURIs})});});});}};export default Spotify;","map":{"version":3,"names":["clientID","redirectURI","accessToken","Spotify","getAccessToken","accessTokenMatch","window","location","href","match","expiresInMatch","expiresIn","Number","setTimeout","history","pushState","accessURL","search","term","fetch","headers","Authorization","then","response","json","jsonResponse","tracks","items","map","track","id","name","artists","album","uri","savePlayList","trackURIs","length","userId","method","body","JSON","stringify","playlistID","console","log","uris"],"sources":["D:/coding/PlaylistCreator/src/util/Spotify.js"],"sourcesContent":["const clientID = \"bc57124bede849018a048bcb3284f8be\";\r\nconst redirectURI = \"http://localhost:3000/\";\r\n\r\nlet accessToken;\r\n\r\nconst Spotify = {\r\n    getAccessToken() {\r\n        if(accessToken) {\r\n            return accessToken;\r\n        }\r\n\r\n        //check for access token match\r\n        const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\r\n        const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\r\n\r\n        if (accessTokenMatch && expiresInMatch) {\r\n            accessToken = accessTokenMatch[1];\r\n            const expiresIn = Number(expiresInMatch[1]);\r\n            //This clears the paramenters allowsing us to grab a new access token when it expires\r\n            window.setTimeout(() => accessToken = '', expiresIn * 1000);\r\n            window.history.pushState('Access Token', null, '/');\r\n            return accessToken;\r\n        } else {\r\n            const accessURL = `https://accounts.spotify.com/authorize?client_id=${clientID}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectURI}`;\r\n            window.location = accessURL;\r\n\r\n        }\r\n    },\r\n    search(term) {\r\n        const accessToken = Spotify.getAccessToken();\r\n\r\n        return fetch(`https://api.spotify.com/v1/search?type=track&q=${term}`, \r\n        {   headers: {\r\n                Authorization: `Bearer ${accessToken}`\r\n            }\r\n        }).then(response => {\r\n            return response.json();\r\n        }).then(jsonResponse => {\r\n            if (!jsonResponse.tracks) {\r\n                return [];\r\n\r\n            }\r\n            return jsonResponse.tracks.items.map(track => ({\r\n                id: track.id,\r\n                name: track.name,\r\n                artists: track.artists[0].name,\r\n                album: track.album.name,\r\n                uri:track.uri\r\n\r\n            }));\r\n        });\r\n    },\r\n\r\n    savePlayList(name, trackURIs) {\r\n        if (!name || !trackURIs.length) {\r\n            return;\r\n        }\r\n        \r\n        const accessToken = Spotify.getAccessToken();\r\n        const headers = {Authorization: `Bearer ${accessToken}`};\r\n        let userId;\r\n\r\n        return fetch('https://api.spotify.com/v1/me', {headers: headers})\r\n        .then(response => response.json())\r\n        .then(jsonResponse => {\r\n            userId=jsonResponse.id;\r\n            return fetch(`https://api.spotify.com/v1/users/${userId}/playlists`,\r\n            {\r\n                headers: headers,\r\n                method: 'POST',\r\n                body: JSON.stringify({name:name})\r\n            })\r\n                .then(response => response.json())\r\n                .then(jsonResponse => {\r\n                const playlistID = jsonResponse.id;\r\n                console.log(playlistID);\r\n                return fetch(`https://api.spotify.com/v1/users/${userId}/playlists/${playlistID}/tracks`,\r\n                {\r\n                    headers: headers,\r\n                    method: 'POST',\r\n                    body: JSON.stringify({uris: trackURIs})\r\n                });\r\n        })\r\n    })\r\n}\r\n}\r\n\r\n\r\nexport default Spotify;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}